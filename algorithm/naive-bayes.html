<!DOCTYPE html><html>

<head>
<meta charset="utf-8">
<title></title>
<style>
html,body{ font-family: Anonymous, ".PingFang SC","PingFang SC", "Neue Haas Grotesk Text Pro", "Arial Nova", "Segoe UI", "Microsoft YaHei", "Microsoft JhengHei", "Helvetica Neue", "Source Han Sans SC", "Noto Sans CJK SC", "Source Han Sans CN", "Noto Sans SC", "Source Han Sans TC", "Noto Sans CJK TC", "Hiragino Sans GB", sans-serif;
  font-size: 16px;
  color:#222
  -webkit-text-size-adjust:none;  min-width: 200px;
  max-width: 760px;
  margin: 0 auto; padding: 1rem;
  line-height: 1.5rem;

}
h1,h2,h3,h4,h5,h6{font-family: Anonymous, ".PingFang SC","PingFang SC", "Neue Haas Grotesk Text Pro", "Arial Nova", "Segoe UI", "Microsoft YaHei", "Microsoft JhengHei", "Helvetica Neue", "Source Han Sans SC", "Noto Sans CJK SC", "Source Han Sans CN", "Noto Sans SC", "Source Han Sans TC", "Noto Sans CJK TC", "Hiragino Sans GB", sans-serif;
text-rendering:optimizelegibility;margin-bottom:1em;font-weight:bold; line-height: 1.8rem;

}
h1,h2{position:relative;padding-top:1rem;padding-bottom:0.2rem;margin-bottom:1rem;background:url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAABCAYAAACsXeyTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAFUlEQVQIHWNIS0sr/v//PwMMDzY+ADqMahlW4J91AAAAAElFTkSuQmCC') bottom left repeat-x;}
h2{padding-top:0.8rem;padding-bottom:0.2rem;}
h1{ font-size: 1.5rem;}
h2{ font-size: 1.3rem;}
h3{ font-size: 1.1rem;}
h4{ font-size: 1.0rem;}
h5{ font-size: 1.0rem;}
h6{ font-size: 0.9rem;}

table{border-collapse:collapse;border-spacing:0;
  margin-top: 0.8rem;
  margin-bottom: 1.4rem;
}
tr{  background-color: #fff;
  border-top: 1px solid #ccc;}
th,td{padding: 5px 14px;
  border: 1px solid #ddd;}

blockquote{font-style:italic;font-size:1.1em;line-height:1.5em;padding-left:1em; border-left:4px solid #D5D5D5;    margin-left: 0;
    margin-right: 0;
    margin-bottom: 1.5rem; }

a{color:#1863a1}

pre,code,p code,li code{font-family:Anonymous, Menlo,Monaco,"Andale Mono","lucida console","Courier New",monospace}

@font-face {
font-family: Anonymous;
src: url(/Users/adavindes/Downloads/font/AnonymousPro-1.002.001/Anonymous\ Pro.ttf );
}

pre{-webkit-border-radius:0.4em;-moz-border-radius:0.4em;-ms-border-radius:0.4em;-o-border-radius:0.4em;border-radius:0.4em;border:1px solid #e7dec3;line-height:1.45em;font-size:0.9rem;margin-bottom:2.1em;padding:.8em 1em;color:#586e75;overflow:auto; background-color:#fff;}

p code,li code{display:inline-block;white-space:no-wrap;background:#fff;font-size:0.8rem;line-height:1.5em;color:#555;border:1px solid #ddd;-webkit-border-radius:0.4em;-moz-border-radius:0.4em;-ms-border-radius:0.4em;-o-border-radius:0.4em;border-radius:0.4em;padding:0 .3em;margin:-1px 4px;}
p pre code,li pre code{font-size:1em !important;background:none;border:none}

img{max-width:100%;-webkit-border-radius:0.3em;-moz-border-radius:0.3em;-ms-border-radius:0.3em;-o-border-radius:0.3em;border-radius:0.3em;-webkit-box-shadow:rgba(0,0,0,0.15) 0 1px 4px;-moz-box-shadow:rgba(0,0,0,0.15) 0 1px 4px;box-shadow:rgba(0,0,0,0.15) 0 1px 4px;-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;border:#fff 0.5em solid}


hr {
  height: 0;
  margin: 15px 0;
  overflow: hidden;
  background: transparent;
  border: 0;
  border-bottom: 1px solid #ddd;
}


/*

Orginal Style from ethanschoonover.com/solarized (c) Jeremy Hull <sourdrums@gmail.com>

*/

.hljs {
  display: block;
  overflow-x: auto;
  padding: 0.5em;
  background: #fff;
  color: #657b83;
  -webkit-text-size-adjust: none;
}

.hljs-comment,
.diff .hljs-header,
.hljs-doctype,
.hljs-pi,
.lisp .hljs-string {
  color: #93a1a1;
}

/* Solarized Green */
.hljs-keyword,
.hljs-winutils,
.method,
.hljs-addition,
.css .hljs-tag,
.hljs-request,
.hljs-status,
.nginx .hljs-title {
  color: #859900;
}

/* Solarized Cyan */
.hljs-number,
.hljs-command,
.hljs-string,
.hljs-tag .hljs-value,
.hljs-rule .hljs-value,
.hljs-doctag,
.tex .hljs-formula,
.hljs-regexp,
.hljs-hexcolor,
.hljs-link_url {
  color: #2aa198;
}

/* Solarized Blue */
.hljs-title,
.hljs-localvars,
.hljs-chunk,
.hljs-decorator,
.hljs-built_in,
.hljs-identifier,
.vhdl .hljs-literal,
.hljs-id,
.css .hljs-function,
.hljs-name {
  color: #268bd2;
}

/* Solarized Yellow */
.hljs-attribute,
.hljs-variable,
.lisp .hljs-body,
.smalltalk .hljs-number,
.hljs-constant,
.hljs-class .hljs-title,
.hljs-parent,
.hljs-type,
.hljs-link_reference {
  color: #b58900;
}

/* Solarized Orange */
.hljs-preprocessor,
.hljs-preprocessor .hljs-keyword,
.hljs-pragma,
.hljs-shebang,
.hljs-symbol,
.hljs-symbol .hljs-string,
.diff .hljs-change,
.hljs-special,
.hljs-attr_selector,
.hljs-subst,
.hljs-cdata,
.css .hljs-pseudo,
.hljs-header {
  color: #cb4b16;
}

/* Solarized Red */
.hljs-deletion,
.hljs-important {
  color: #dc322f;
}

/* Solarized Violet */
.hljs-link_label {
  color: #6c71c4;
}

.tex .hljs-formula {
  background: #fff;
}


</style>

<script src="asset/highlightjs/highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script>
<script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({TeX: { equationNumbers: { autoNumber: "AMS" } }});</script>
<style> @media print{ .hljs{overflow: visible; word-wrap: break-word !important;} }</style></head><body><div class="markdown-body">
<h3 id="toc_0">朴素贝叶斯法</h3>

<p>基于贝叶斯定理和特征条件独立假设的分类方法，属于生成方法，对于给定的训练数据集，首先基于特征条件独立假设学习输入/输出的联合概率分布；据此求出后验概率最大的输出\(y\)</p>

<h4 id="toc_1">贝叶斯定理</h4>

<p>\(P(A|B) = \frac{P(B|A)P(A)}{P(B)}\)</p>

<p><strong>证明</strong></p>

<p>根据条件概率的定义：</p>

<p>\[P(A|B) = \frac{P(A \cap B)}{P(B)}\]</p>

<p>右式分母左乘，得：</p>

<p>\[P(A|B)P(B) = P(A \cap B) = P(B|A)P(A)\]</p>

<p>从而：</p>

<p>\[P(A|B) = \frac{P(B|A)P(A)}{P(B)}\]</p>

<h4 id="toc_2">先验概率</h4>

<p><strong>先验概率分布</strong></p>

<p>\[P(Y=c_k), k = 1, 2, 3, ..., K\]</p>

<p><strong>先验条件概率</strong></p>

<p>\[P(X=x\ | \ Y=c_k ) = P(X^{(1)}=x^{(1)}, ..., X^{(n)}=x^{(n)}\ | \ Y=c_k)\]</p>

<p>由上可得到联合概率分布 \(P(X, Y)\)</p>

<h4 id="toc_3">条件独立性</h4>

<p>指分类的特征在类确定的条件下都是条件独立的，从而朴素贝叶斯法中的条件概率可以表示为：</p>

<p>\[P(X=x|Y=c_K)=\prod_{j=1}^nP(X^{(j)}=x^{(j)}\ | \ Y=c_k)\]</p>

<h4 id="toc_4">后验概率</h4>

<p>朴素贝叶斯法分类时，对给点的 \(x\)，获得后验概率分布\(P(Y= c_k \ |\ X = x) \)。后验概率计算根据贝叶斯定理展开：</p>

<p>\[P(Y= c_k \ | \ X = x) = \frac{P(Y=c_k)\prod_{j=1}^nP(X^{(j)}=x^{(j)}\ | \ Y=c_k)}{\sum_{k}{P(X=x\ | Y=c_k)P(Y=c_k)}}\]</p>

<p>进一步转换分母中的式子，得：</p>

<p>\[P(Y= c_k \ | \ X = x) = \frac{P(Y=c_k)\prod_{j=1}^nP(X^{(j)}=x^{(j)}\ | \ Y=c_k)}{\sum_{k}P(Y=c_k){\prod_{k}(X^{(j)}=x^{(j)})\ |\ Y=c_k)}}\]</p>

<p>其中，\(k=1, 2, ..., K\)</p>

<p>如上即为朴素贝叶斯法的基本公式，从而朴素贝叶斯分类可表示为：</p>

<p>\[y=f(x) = argmax\frac{P(Y=c_k)\prod_{j=1}^nP(X^{(j)}=x^{(j)}\ | \ Y=c_k)}{\sum_{k}P(Y=c_k){\prod_{k}(X^{(j)}=x^{(j)})\ |\ Y=c_k)}}\]</p>

<p>由于分母部分是一定的，从而实质上要求的是：</p>

<p>\[P(Y=c_k)\prod_{j=1}^nP(X^{(j)}=x^{(j)}\ | \ Y=c_k)\]</p>

<p>从而看到，朴素贝叶斯分类器可理解为使后验概率最大化的过程。</p>

<p>而后验概率最大化，即使期望风险最小化的过程。因为，如书中，采用 0-1 损失函数，那么，期望风险函数\(R_{exp}(f)\)可表示为：</p>

<p>\[E_X\sum_{k=1}^K[L(c_k, f(X))]KP(c_K\ |\ X)\]</p>

<p>要使期望风险最小化，即求</p>

<p>\[\begin{align*}<br/>
argminE_X\sum_{k=1}^K[L(c_k, f(X))]P(c_K\ |\ X) \\<br/>
\end{align*}\]</p>

<p>由于使用了0-1损失函数，上式可进一步化简为：</p>

<p>\[argminE_X\sum_{k=1}^kP(c_K \not = y\ |\ X)\]</p>

<p>即为：</p>

<p>\[argmaxP(c_K = y \ |\ X)\]</p>

<h4 id="toc_5">极大似然估计</h4>

<p>朴素贝叶斯法中，学习需要骨散以下两个概率：</p>

<ol>
<li><p>\[P(y=c_k)=\frac{\sum_{i=1}^{N}{I(y_i=c_k)}}{N}， k=1,2,...,K \]</p></li>
<li><p>\[P(X^{j}=a_{ji}|Y=c_k)=\frac{\sum_{i=1}^{N}{I(x_i^{j}=a_{jl},y_i =c_k)}}{\sum_{i=1}^{N}I(y_i=c_k )}\  j=1,2,3...,n;l=1,2,3...,S_j;k=1,2,...,K\]</p></li>
</ol>

<p>在上式中，\(x_i^{j}\) 表示第 \(i\) 个样本的第 \(j\) 个特征;\(a_{jl}\)表示第\(j\)个特征可能取的第\(l\)个值</p>

<h4 id="toc_6">学习与分类算法</h4>

<ol>
<li>计算先验概率及条件概率</li>
</ol>

<p>\[P(y=c_k)=\frac{\sum_{i=1}^{N}{I(y_i=c_k)}}{N}， k=1,2,...,K \]</p>

<p>\[P(X^{j}=a_{ji}|Y=c_k)=\frac{\sum_{i=1}^{N}{I(x_i^{j}=a_{jl},y_i =c_k)}}{\sum_{i=1}^{N}I(y_i=c_k )}\]</p>

<ol>
<li><p>对于给定的实例\(x=(x^{1},x^{2},...,x^{n})^T\)，计算：</p>

<p>\[P(Y=c_k)\prod_{j=1}^nP(X^{(j)}=x^{(j)}\ | \ Y=c_k)\]</p></li>
<li><p>确定实例 \(x\) 的类：</p>

<p>\[argmaxP(Y=c_k)\prod_{j=1}^nP(X^{(j)}=x^{(j)}\ | \ Y=c_k)\]    </p></li>
</ol>

<h4 id="toc_7">贝叶斯估计</h4>

<p>使用极大似然估计，可能造成所要估计的概率值为 0,会防止此影响后验概率的计算结果，可采用贝叶斯估计：</p>

<p>其中，条件概率的贝叶斯估计是：</p>

<p>\[P(X^{j}=a_{ji}|Y=c_k)=\frac{\sum_{i=1}^{N}{I(x_i^{j}=a_{jl},y_i =c_k)+\lambda}}{\sum_{i=1}^{N}I(y_i=c_k )+S_j \lambda}\]</p>

<p>而对应的先验概率的贝叶斯估计是：</p>

<p>\[P(y=c_k)=\frac{\sum_{i=1}^{N}{I(y_i=c_k)+\lambda}}{N+K\lambda}， k=1,2,...,K \]</p>

</div></body>

</html>
